# Penetration Test Report â€“ Phase 2 (Registration System)

## 1ï¸âƒ£ Introduction

**Tester(s):**  
- J-PCode

**Purpose:**  
- Identify vulnerabilities and anomalies in the registration functionality of the Booking System (Phase 2).  
- Verify if previously found issues from Phase 1 have been fixed and to identify regressions.

**Scope:**  
- **Included:**  
  - Registration form (Email, Password, Age, Role)  
  - Client-side and server-side validation  
  - Role assignment handling  
  - Input sanitization (SQLi, XSS)  
  - Interception attacks (ZAP/Burp)  
  - Database checks: `booking_users`  
- **Excluded:**  
  - Login flow  
  - Reservation logic  
  - Administrator UI  
  - Session management  

**Test approach:**  
- Gray-box penetration testing  
- Manual testing + ZAP  
- Direct database validation (PostgreSQL)

**Test environment & dates:**  
- Start: 01.12.2025  
- End: 02.12.2025  
- Environment: Local Docker lab environment (web + PostgreSQL)  
- Tools: Browser devtools, OWASP ZAP, psql

**Assumptions & constraints:**  
- Testing only Phase 2 version  
- No rate limiting implemented  

---

## 2ï¸âƒ£ Executive Summary

The registration system contains multiple medium and high-severity vulnerabilities, including:

- Privilege escalation via intercepted role field  
- Missing server-side validation (age, role)  
- SQLi payload accepted in password field  
- Weak duplicate email protection  

**Overall risk level: ğŸ”´ HIGH**

### Top 5 immediate actions
1. Add server-side validation for age, role, password strength, and email.  
2. Enforce backend role assignment (`reservist` only).  
3. Sanitize and reject SQLi/XSS payloads.  
4. Use prepared statements throughout backend.  
5. Unify error messaging to prevent user enumeration.

---

## 3ï¸âƒ£ Severity scale & definitions

| Severity | Description | Action |
|---------|-------------|--------|
| ğŸ”´ High | Leads to privilege escalation or data compromise | Fix immediately |
| ğŸŸ  Medium | Exploitable but requires conditions | Fix ASAP |
| ğŸŸ¡ Low | Minor weakness | Fix soon |
| ğŸ”µ Info | No direct risk | Monitor |

---

## 4ï¸âƒ£ Findings

### F-01 â€” ğŸ”´ HIGH â€” Privilege Escalation via Role Manipulation
**Description:** User can intercept POST request and change `role=administrator`.  
**Impact:** Anyone can create admin-level accounts.  
**Evidence:** Interception confirmed to work.

---

### F-02 â€” ğŸŸ  Medium â€” Weak Input Validation (SQLi Payload Accepted)
**Description:** Password field accepts SQLi payload without sanitation.  
**Impact:** Future SQL risk, possible XSS if reflected.  
**Evidence:** Payload accepted: `test'); DROP TABLE booking_users; --`


---

### F-03 â€” ğŸŸ¡ Low â€” User Enumeration via Duplicate Email
**Description:** System clearly reveals when email exists.  
**Impact:** Attackers can identify valid users.  
**Evidence:** Duplicate registration rejected with clear message.

---

## 5ï¸âƒ£ OWASP ZAP Test Report

Attach:  

---

## Final Notes

AI used in this report (since this is not requested document for this assignment). Tested my self these steps but text generated with AI with test results i provided. checked and edited by me.

Most vulnerabilities come from trusting client-side values and lacking backend validation. Critical fixes should be implemented before proceeding to next development phase.
